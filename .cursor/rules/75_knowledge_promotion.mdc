# 75_knowledge_promotion.mdc
# Knowledge Promotion Rules（ナレッジ昇格判断ルール）

## 1. 目的
本ルールは、Obsidianプロジェクトディレクトリ内の学び・判断・作業ファイルから、`/mnt/d/work/obsidian/cursor/20_KNOWLEDGE/` に昇格させるべき知見を判断するための基準を定義する。

ナレッジ化は「再利用可能な知見の資産化」を目的とし、次回のプロジェクトで活用できる状態にする。

---

## 2. Knowledge 昇格判断基準

### 2.1 判断の観点（4つの観点）
Knowledge 化すべきか判断する際は、以下の4つの観点で評価する：

#### 2.1.1 再利用性（Reusability）
> 別のプロジェクト・文脈でも使えるか

- **別PJでも使える**
  - 他のプロジェクトでも同じ状況が発生する可能性がある
  - プロジェクト固有の制約に依存していない
- **技術やツールが変わっても本質は変わらない**
  - 特定の技術スタックに依存していない
  - 抽象度が適切で、実装詳細に依存していない
- **特定PJ依存ではない**
  - このプロジェクト固有の事情に依存していない
  - 汎用的な原則・パターンとして表現できる
- **時間が経っても有効**
  - 一時的なトレンドに依存していない
  - 長期的に価値がある

#### 2.1.2 判断価値（Decision Value）
> なぜそうしたかの判断プロセスに価値があるか

- **なぜそうしたか説明できる**
  - 判断理由が明確で、再現可能なプロセスがある
  - 「なぜAではなくBを選んだか」が説明できる
- **失敗 or 成功の理由が明確**
  - 成功/失敗の要因が特定できている
  - 再現性のある要因が含まれている
- **判断ミスを防げる**
  - 同じ判断ミスを繰り返さないための知見がある
  - 判断の落とし穴・注意点が明確
- **トレードオフが明確**
  - 選択肢の比較が明確
  - トレードオフの考慮点が記録されている
- **判断基準が一般化できる**
  - 特定の判断基準が他の状況でも使える
  - 判断フロー・チェックリストとして表現できる

#### 2.1.3 実務効果（Practical Impact）
> 実際の業務に役立つか

- **時間短縮につながる**
  - 次回同じことを考える時間を削減できる
  - 調査・検討時間を短縮できる
- **レビュー品質が上がる**
  - コードレビュー・設計レビューの品質向上に寄与する
  - 見落としを防げる
- **属人化を防げる**
  - 個人の経験・暗黙知を形式知化できる
  - チーム全体で共有できる
- **再発防止につながる**
  - 同じ問題・失敗を繰り返さない
  - 予防策として機能する
- **学習コストを下げる**
  - 新人・他メンバーの学習コストを下げる
  - オンボーディングに役立つ
- **意思決定の速度向上**
  - 判断に迷う時間を削減できる
  - 迅速な意思決定を支援する

#### 2.1.4 表現可能性（Expressibility）
> Knowledgeとして適切に表現できるか

- **1ファイルにまとめられる**
  - 1つのKnowledgeファイルとして完結できる
  - 複数のファイルに分割する必要がない
- **抽象度を1段上げられる**
  - 具体例から一般原則を抽出できる
  - 抽象化レベルが適切
- **他人が読んでも理解できる**
  - 文脈を知らない人でも理解できる
  - 必要な前提知識が明確
- **検索・発見しやすい**
  - 適切なカテゴリ（decision/pitfall/pattern/prompt/mcp）に分類できる
  - キーワード・タグで検索しやすい
- **具体例と抽象化のバランスが取れている**
  - 具体例が適切に含まれている
  - 抽象化が過度でない
- **更新・メンテナンスしやすい**
  - 将来の更新が容易
  - 古くなりにくい構造

### 2.2 昇格判断基準
- **合計3つ以上 Yes** が付いたら Knowledge 化を推奨する
- 各観点で Yes が1つ以上あることが望ましい
- ただし、特定の観点で特に価値が高い場合は例外あり

---

## 3. Knowledge カテゴリ分類

### 3.1 カテゴリの定義
Knowledge 化する場合、適切なカテゴリを決定する：

- **decision/**：判断・選択に関する知見
  - 判断基準・判断プロセスが明確
  - トレードオフの考慮点が記録されている
- **pitfall/**：ハマりどころ・失敗事例
  - 再発しやすい失敗
  - 回避方法が明確なもの
- **pattern/**：実装・運用の定石
  - 実装・運用の定石
  - 繰り返し使えるパターン
- **prompt/**：AIプロンプトの知見
  - 効果的なプロンプト
  - 再利用可能なプロンプトパターン
- **mcp/**：MCP操作の定型
  - MCP操作の定型
  - よく使う操作パターン

### 3.2 カテゴリ決定の判断基準
- 判断・選択に関する内容 → decision/
- 失敗・ハマりどころに関する内容 → pitfall/
- 実装・運用の定石に関する内容 → pattern/
- AIプロンプトに関する内容 → prompt/
- MCP操作に関する内容 → mcp/

---

## 4. ナレッジ化の対象

### 4.1 Obsidianプロジェクトディレクトリ内の対象ファイル
以下のファイルからナレッジ化候補を抽出する：

- **00_OVERVIEW.md**：PJ総評
  - 実施内容サマリから学びを抽出
  - レビュー・注意点から知見を抽出
- **01_DECISIONS.md**：判断ログ
  - 各判断（D-XXX）から判断パターンを抽出
  - 判断パターンセクションから知見を抽出
- **02_LESSONS.md**：学び
  - 各学び（L-XXX）から知見を抽出
  - ナレッジ化候補セクションを確認
- **04_TASKS.md**：タスクまとめ
  - 実施内容から実装パターンを抽出
  - 検証結果から検証パターンを抽出
  - 残課題・懸念からハマりどころを抽出
- **99_work_files/**：作業ファイル
  - debug-log.txt：デバッグ時の知見
  - design-draft.md：設計時の判断・選択
  - memo-YYYYMMDD.md：作業メモから知見を抽出

### 4.2 抽出の観点
各ファイルから以下の観点で知見を抽出する：

- **判断・選択**：なぜそうしたか、判断基準は何か
- **失敗・ハマりどころ**：何が問題だったか、どう回避するか
- **成功パターン**：何がうまくいったか、どう再現するか
- **実装パターン**：どう実装したか、なぜその方法を選んだか
- **検証パターン**：どう検証したか、何を確認したか
- **プロセス改善**：プロセス上の学び、改善提案

---

## 5. ナレッジ化の手順

### 5.1 知見の抽出
1) Obsidianプロジェクトディレクトリ内の全ファイルを読み込む
2) 各ファイルから知見を抽出する（上記4.2の観点で）
3) 抽出した知見をリストアップする

### 5.2 昇格判断
1) 各知見について、2.1の4つの観点で評価する
2) Yes数をカウントする
3) **合計3つ以上 Yes** の場合、Knowledge 化を推奨する
4) カテゴリを決定する（3.1の基準で）

### 5.3 Knowledge ファイル作成
1) 適切なカテゴリのテンプレートを参照する
   - `/mnt/d/work/obsidian/cursor/20_KNOWLEDGE/TEMPLATES/decision_entry.md`
   - `/mnt/d/work/obsidian/cursor/20_KNOWLEDGE/TEMPLATES/pitfall_entry.md`
   - `/mnt/d/work/obsidian/cursor/20_KNOWLEDGE/TEMPLATES/pattern_entry.md`
   - `/mnt/d/work/obsidian/cursor/20_KNOWLEDGE/TEMPLATES/prompt_entry.md`
   - `/mnt/d/work/obsidian/cursor/20_KNOWLEDGE/TEMPLATES/mcp_entry.md`
2) テンプレートに従って内容を記入する
   - **重要**：ユースケース・適用前提・状況判断のための前提を必ず記入する
   - 複数のPJで矛盾が起きないように、適用条件を具体的に記述する
3) 既存のKnowledgeファイルと重複がないか確認する
   - `/mnt/d/work/obsidian/cursor/20_KNOWLEDGE/<category>/` 配下の既存ファイルを確認
4) 重複がない場合、新しいKnowledgeファイルを作成する
   - `/mnt/d/work/obsidian/cursor/20_KNOWLEDGE/<category>/<filename>.md`
5) INDEX.md を更新する
   - `/mnt/d/work/obsidian/cursor/20_KNOWLEDGE/INDEX.md` を更新

### 5.4 記録
1) Obsidianプロジェクトディレクトリ内の該当ファイルを更新する
   - `02_LESSONS.md` の「ナレッジ化候補」セクションに「昇格済み」として記録
   - `01_DECISIONS.md` の「判断パターン」セクションに「昇格済み」として記録（該当時）
2) Knowledge ファイルへのリンクを追加する

---

## 6. ルール再定義の判断

### 6.1 ルール再定義が必要なケース
プロジェクトで発見した問題・改善点を基に、以下を判断する：

- 既存ルールが不十分で、迷いが発生した
- 既存ルールに従ったが、問題が発生した
- 新しいパターンが発見され、ルール化すべき
- ルールの解釈が曖昧で、明確化が必要

### 6.2 ルール再定義の対象
以下のルールファイルを更新対象とする：

- **実行モデル（10_execution_model.mdc）**
  - フェーズ遷移の改善
  - 必須項目の追加・変更
  - 禁止事項の追加・変更
- **GitHub運用（20_github.mdc）**
  - Issue管理の改善
  - テンプレートの改善
- **ディレクトリ（30_directory.mdc）**
  - SSOTの明確化
  - ディレクトリ構造の改善
- **コマンド契約（40_command_contracts.mdc）**
  - コマンド責務の明確化
  - 成果物の追加・変更
- **コードルール（50_app_code.mdc / 60_infra_code.mdc）**
  - コーディング規約の改善
  - 実装パターンの追加
- **ナレッジ管理（70_knowledge.mdc）**
  - ナレッジ化基準の明確化
  - テンプレートの改善
- **環境・ツール（80_environment.mdc）**
  - ツール設定の改善
  - MCP操作の改善

### 6.3 ルール再定義の手順
1) 問題・改善点を特定する
2) どのルールファイルを更新すべきか判断する
3) ルール更新案を検討する
4) ルールファイルを更新する
5) 更新内容を記録する（01_DECISIONS.md の「判断パターン」セクション）

---

## 7. 禁止事項

- プロジェクト固有の情報を Knowledge 化すること
- 一時的なトレンドに依存する情報を Knowledge 化すること
- 抽象度が低すぎる具体例を Knowledge 化すること
- 再利用性・判断価値・実務効果・表現可能性を考慮せずに Knowledge 化すること
- **重複チェックをせずに Knowledge 化すること**
- **既存Knowledgeと重複する内容を、前提条件の違いを明確にせずに Knowledge 化すること**
  - 同じ内容・同じ前提条件のKnowledgeが既に存在する場合は重複とみなす
  - 前提条件や環境が異なる場合は重複とみなさない（別のKnowledgeとして作成可能）

---

## 8. 参照

- Knowledge 管理ルール：`.cursor/rules/70_knowledge.mdc`（**必ず参照して理解して実施する**）
- Knowledge レビューコマンド：`.cursor/commands/knowledge.md`
- Knowledge Entry Templates：`/mnt/d/work/obsidian/cursor/20_KNOWLEDGE/TEMPLATES/{decision,pitfall,pattern,prompt,mcp}_entry.md`
- Obsidianテンプレート：`/mnt/d/work/obsidian/cursor/90_TEMPLATES/knowledge_review.md`（参考用）
- AI Knowledge ディレクトリ：`/mnt/d/work/obsidian/cursor/20_KNOWLEDGE/`（SSOT）
